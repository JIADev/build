<?xml version="1.0"?>
<cb:config-template xmlns:cb="urn:ccnet.config.builder">
  <cb:define name="v76build">
    <cb:define project-root="$(driver)-$(branch)$(bookmark)$(tag)" />
    <cb:define project-name="$(project-root)" />
    <cb:define db-name="$(project-name)-DEV" />
    
    <project name="$(project-name)" category="$(driver)" queue="$(project-root)-build" queuePriority="2">
      <triggers>
	<intervalTrigger seconds = "$(sourceCheckInterval)" />
      </triggers>
      <cb:define project-folder="$(ccroot)\$(project-name)" />
      <workingDirectory>$(project-folder)</workingDirectory>
      <artifactDirectory>$(artifact-folder)</artifactDirectory>
      <sourcecontrol type="hg">
	<autoGetSource>false</autoGetSource>
	<workingDirectory>$(source-folder)</workingDirectory>
	<timeout>120000</timeout>
	<repo>$(source)</repo>
	<multipleHeadsFail>false</multipleHeadsFail>
	<tagOnSuccess>false</tagOnSuccess>
	<commitModifications>false</commitModifications>
	<commitUntracked>false</commitUntracked>
	<purgeModifications>true</purgeModifications>
	<revertModifications>true</revertModifications>
	<tagCommitMessage>Tagging CC.NET build {0}</tagCommitMessage>
	<modificationsCommitMessage>Modifications of CC.NET build {0}</modificationsCommitMessage>
	<tagNameFormat>ccnet_build_{0}</tagNameFormat>
	<committerName>CruiseControl.NET</committerName>
	<branch>$(branch)</branch>
      </sourcecontrol>
      <prebuild>
	<cb:update-source />
	<cb:force-clean />
      </prebuild>
      <tasks description="Bootstrap setup">
	<cb:copy-logger-local />
	<cb:msbuild-configure />
	<cb:msbuild-bootstrap />
	<cb:msbuild-setup />
	<cb:msbuild-install-patches />
	<cb:msbuild-build />
	<cb:setup-unittests />
	<cb:get-reports />
	<cb:msbuild-package />
      </tasks>
      <publishers>
	<!--<cb:standard-publishers />-->
	<!--<cb:define name="standard-publishers">-->
	<merge>
	  <files>
	    <file>TestResult\*.xml</file>
	    <file>Coverage\SymbolModule.xml</file>
	    <file>TestResult\FxCop-results.xml</file>
	    <file action="Copy">NDepend\*</file>
	  </files>
	</merge>
	<xmllogger />
	<statistics />
	<!--</cb:define>-->
      </publishers>
      <externalLinks>
	<externalLink name="root" url="$(ccwebroot)" />
      </externalLinks>
      <webURL>$(ccwebroot)server/$(ccBuildServer)/project/$(project-name)/ViewProjectReport.aspx</webURL>
    </project>
  </cb:define>	
</cb:config-template>
